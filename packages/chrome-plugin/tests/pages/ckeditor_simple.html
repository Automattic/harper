<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>CKEditor Sync Test</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
      }

      .ck-editor__editable {
        border: 1px solid #ccc;
        border-radius: 8px;
        min-height: 160px;
        padding: 1rem;
      }
    </style>
  </head>
  <body>
    <h1>CKEditor Sync Test</h1>
    <div class="ck-editor">
      <div
        class="ck-editor__editable ck-content"
        contenteditable="true"
        role="textbox"
        aria-label="Editor"
      >
        <p></p>
      </div>
    </div>

    <script>
      const editor = document.querySelector('.ck-editor__editable');
      const paragraph = editor.querySelector('p');
      let model = 'This is an test';

      const render = () => {
        paragraph.textContent = model;
      };

      render();

      editor.addEventListener('beforeinput', (event) => {
        if (typeof event.data !== 'string') return;

        if (!event.isTrusted && event.inputType === 'insertText') {
          event.preventDefault();
          model = event.data;
          render();
          return;
        }

        if (event.isTrusted && event.inputType === 'insertText') {
          event.preventDefault();
          model = model + event.data;
          render();
        }
      });
    </script>
  </body>
</html>
